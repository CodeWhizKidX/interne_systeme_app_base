generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model UserAuthentications {
  id          BigInt @id @default(autoincrement())
  userId      BigInt @map("user_id")
  provider    String @db.VarChar(50)
  providerSub String @map("provider_sub") @db.VarChar(255)
  users       Users  @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([provider, providerSub])
  @@map("user_authentications")
}

model Users {
  id                  BigInt                @id @default(autoincrement())
  firstName           String                @map("first_name") @db.VarChar(50)
  lastName            String                @map("last_name") @db.VarChar(50)
  emailAddress        String                @unique @map("email_address") @db.VarChar(255)
  status              String                @db.VarChar(20)
  authority           String                @default("user") @db.VarChar(50)
  registrationDate    DateTime              @default(now()) @map("registration_date") @db.Timestamptz(6)
  firstNameKana       String                @map("first_name_kana") @db.VarChar(50)
  lastNameKana        String                @map("last_name_kana") @db.VarChar(50)
  isFirstLoginCompleted Boolean             @default(false) @map("is_first_login_completed")
  displayName         String?               @map("display_name") @db.VarChar(100)
  lastLoginAt         DateTime?             @map("last_login_at") @db.Timestamptz(6)
  stripeCustomerId    String?               @map("stripe_customer_id") @db.VarChar(255)
  userAuthentications UserAuthentications[]

  @@index([lastLoginAt(sort: Desc)], map: "idx_users_last_login_at")
  @@index([stripeCustomerId], map: "idx_users_stripe_customer_id")
  @@map("users")
}
